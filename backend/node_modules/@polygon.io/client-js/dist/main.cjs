var rt=Object.create;var I=Object.defineProperty;var st=Object.getOwnPropertyDescriptor;var ot=Object.getOwnPropertyNames;var nt=Object.getPrototypeOf,it=Object.prototype.hasOwnProperty;var at=(e,t)=>{for(var o in t)I(e,o,{get:t[o],enumerable:!0})},w=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of ot(t))!it.call(e,s)&&s!==o&&I(e,s,{get:()=>t[s],enumerable:!(r=st(t,s))||r.enumerable});return e};var $=(e,t,o)=>(o=e!=null?rt(nt(e)):{},w(t||!e||!e.__esModule?I(o,"default",{value:e,enumerable:!0}):o,e)),ut=e=>w(I({},"__esModule",{value:!0}),e);var mt={};at(mt,{cryptoClient:()=>O,default:()=>pt,forexClient:()=>_,getCryptoWebsocket:()=>v,getForexWebsocket:()=>S,getIndicesWebsocket:()=>G,getStocksWebsocket:()=>A,indicesClient:()=>P,optionsClient:()=>R,polygonClient:()=>tt,referenceClient:()=>C,restClient:()=>Xe,snapshotOptionChain:()=>f,snapshotOptionContract:()=>b,stocksClient:()=>T,websocketClient:()=>Ke});module.exports=ut(mt);var L=$(require("cross-fetch"),1),F={fetch:(e,t)=>(0,L.default)(e,t)};var E=require("query-string"),q=class extends Error{constructor(o,r="",s=""){super(o);this.status=r,this.request_id=s}},i=(e,t,o={})=>async(r,s={},n={})=>{if(!e)throw new Error("API KEY not configured...");let u=(0,E.stringify)(s,{encode:!0}),p=`${t}${r}?${u}`;try{let m=await F.fetch(p,{...o,...n,headers:{...n.headers||o.headers||{},Authorization:`Bearer ${e}`}});if(m.status>=400){let D=await m.text(),h;try{let c=JSON.parse(D);h=new q(c.message,c.status,c.request_id)}catch{h=new Error(D)}throw h}return m?.headers?.get("content-type")==="text/csv"?m.text():m.json()}catch(m){throw m}};var M=async(e,t,o,r,s,n,u,p)=>e(`/v2/aggs/ticker/${t}/range/${o}/${r}/${s}/${n}`,u,p);var W=async(e,t,o,r)=>e(`/v2/aggs/grouped/locale/global/market/crypto/${t}`,o,r);var N=async(e,t,o,r,s,n)=>e(`/v1/open-close/crypto/${t}/${o}/${r}`,s,n);var U=async(e,t,o,r)=>e(`/v3/trades/${t}`,o,r);var z=async(e,t,o,r,s)=>e(`/v1/last/crypto/${t}/${o}`,r,s);var H=async(e,t,o,r)=>e(`/v2/aggs/ticker/${t}/prev`,o,r);var j=(e,t,o)=>e("/v2/snapshot/locale/global/markets/crypto/tickers",t,o),V=(e,t,o,r)=>e(`/v2/snapshot/locale/global/markets/crypto/${t}`,o,r),B=(e,t,o,r)=>e(`/v2/snapshot/locale/global/markets/crypto/tickers/${t}`,o,r),X=(e,t,o,r)=>e(`/v2/snapshot/locale/global/markets/crypto/tickers/${t}/book`,o,r);var J=async(e,t,o)=>e("/v1/summaries",t,o);var g=async(e,t,o,r)=>e(`/v1/indicators/sma/${t}`,o,r);var Y=async(e,t,o,r)=>e(`/v1/indicators/sma/${t}`,o,r);var l=async(e,t,o,r)=>e(`/v1/indicators/ema/${t}`,o,r);var Z=async(e,t,o,r)=>e(`/v1/indicators/ema/${t}`,o,r);var y=async(e,t,o,r)=>e(`/v1/indicators/macd/${t}`,o,r);var K=async(e,t,o,r)=>e(`/v1/indicators/macd/${t}`,o,r);var d=async(e,t,o,r)=>e(`/v1/indicators/rsi/${t}`,o,r);var ee=async(e,t,o,r)=>e(`/v1/indicators/rsi/${t}`,o,r);var te=async(e,t,o)=>e("/v1/summaries",t,o);var O=(e,t="https://api.polygon.io",o)=>{let r=i(e,t,o);return{aggregates:(...s)=>M(r,...s),aggregatesGroupedDaily:(...s)=>W(r,...s),summaries:(...s)=>J(r,...s),dailyOpenClose:(...s)=>N(r,...s),lastTrade:(...s)=>z(r,...s),trades:(...s)=>U(r,...s),previousClose:(...s)=>H(r,...s),snapshotAllTickers:(...s)=>j(r,...s),snapshotGainersLosers:(...s)=>V(r,...s),snapshotTicker:(...s)=>B(r,...s),snapshotTickerFullBookL2:(...s)=>X(r,...s),sma:(...s)=>Y(r,...s),ema:(...s)=>Z(r,...s),macd:(...s)=>K(r,...s),rsi:(...s)=>ee(r,...s)}};var re=async(e,t,o,r,s,n,u,p)=>e(`/v2/aggs/ticker/${t}/range/${o}/${r}/${s}/${n}`,u,p);var se=async(e,t,o,r)=>e(`/v2/aggs/grouped/locale/global/market/fx/${t}`,o,r);var oe=async(e,t,o,r,s)=>e(`/v1/conversion/${t}/${o}`,r,s);var ne=async(e,t,o,r)=>e(`/v3/quotes/${t}`,o,r);var ie=(e,t,o,r,s)=>e(`/v1/last_quote/currencies/${t}/${o}`,r,s);var ae=async(e,t,o,r)=>e(`/v2/aggs/ticker/${t}/prev`,o,r);var ue=async(e,t,o)=>e("/v2/snapshot/locale/global/markets/forex/tickers",t,o),pe=async(e,t,o,r)=>e(`/v2/snapshot/locale/global/markets/forex/${t}`,o,r),me=async(e,t,o,r)=>e(`/v2/snapshot/locale/global/markets/forex/tickers/${t}`,o,r);var ce=async(e,t,o)=>e("/v1/summaries",t,o);var Ie=async(e,t,o,r)=>e(`/v1/indicators/sma/${t}`,o,r);var ge=async(e,t,o,r)=>e(`/v1/indicators/ema/${t}`,o,r);var le=async(e,t,o,r)=>e(`/v1/indicators/macd/${t}`,o,r);var ye=async(e,t,o,r)=>e(`/v1/indicators/rsi/${t}`,o,r);var _=(e,t="https://api.polygon.io",o)=>{let r=i(e,t,o);return{aggregates:(...s)=>re(r,...s),aggregatesGroupedDaily:(...s)=>se(r,...s),summaries:(...s)=>ce(r,...s),conversion:(...s)=>oe(r,...s),quotes:(...s)=>ne(r,...s),lastQuote:(...s)=>ie(r,...s),previousClose:(...s)=>ae(r,...s),snapshotAllTickers:(...s)=>ue(r,...s),snapshotGainersLosers:(...s)=>pe(r,...s),snapshotTicker:(...s)=>me(r,...s),sma:(...s)=>Ie(r,...s),ema:(...s)=>ge(r,...s),macd:(...s)=>le(r,...s),rsi:(...s)=>ye(r,...s)}};var de=async(e,t,o)=>e("/v3/reference/conditions",t,o);var fe=async(e,t,o)=>e("/v3/reference/exchanges",t,o);var be=async(e,t,o)=>e("/v1/marketstatus/upcoming",t,o);var xe=async(e,t,o)=>e("/v1/marketstatus/now",t,o);var ke=(e,t,o,r)=>e(`/v3/reference/options/contracts/${t}`,o,r);var Qe=(e,t,o)=>e("/v3/reference/options/contracts",t,o);var he=async(e,t,o)=>e("/v3/reference/dividends",t,o);var qe=async(e,t,o)=>e("/v3/reference/splits",t,o);var Oe=async(e,t,o)=>e("/vX/reference/financials",t,o);var _e=async(e,t,o,r)=>e(`/v3/reference/tickers/${t}`,o,r);var Ce=async(e,t,o)=>e("/v2/reference/news",t,o);var Re=async(e,t,o)=>e("/v3/reference/tickers",t,o);var Te=async(e,t,o)=>e("/v3/reference/tickers/types",t,o);var C=(e,t="https://api.polygon.io",o)=>{let r=i(e,t,o);return{conditions:(...s)=>de(r,...s),exchanges:(...s)=>fe(r,...s),marketHolidays:(...s)=>be(r,...s),marketStatus:(...s)=>xe(r,...s),optionsContract:(...s)=>ke(r,...s),optionsContracts:(...s)=>Qe(r,...s),dividends:(...s)=>he(r,...s),stockSplits:(...s)=>qe(r,...s),stockFinancials:(...s)=>Oe(r,...s),tickerDetails:(...s)=>_e(r,...s),tickerNews:(...s)=>Ce(r,...s),tickers:(...s)=>Re(r,...s),tickerTypes:(...s)=>Te(r,...s)}};var Pe=async(e,t,o,r,s,n,u,p)=>e(`/v2/aggs/ticker/${t}/range/${o}/${r}/${s}/${n}`,u,p);var ve=async(e,t,o,r,s)=>e(`/v1/open-close/${t}/${o}`,r,s);var Se=async(e,t,o,r)=>e(`/v2/aggs/ticker/${t}/prev`,o,r);var Ge=async(e,t,o,r)=>e(`/v3/trades/${t}`,o,r);var Ae=async(e,t,o,r)=>e(`/v2/last/trade/${t}`,o,r);var De=async(e,t,o,r)=>e(`/v3/quotes/${t}`,o,r);var f=async(e,t,o,r)=>e(`/v3/snapshot/options/${t}`,o,r),b=async(e,t,o,r,s)=>e(`/v3/snapshot/options/${t}/${o}`,r,s);var we=async(e,t,o)=>e("/v1/summaries",t,o);var $e=async(e,t,o,r)=>e(`/v1/indicators/sma/${t}`,o,r);var Le=async(e,t,o,r)=>e(`/v1/indicators/ema/${t}`,o,r);var Fe=async(e,t,o,r)=>e(`/v1/indicators/macd/${t}`,o,r);var Ee=async(e,t,o,r)=>e(`/v1/indicators/rsi/${t}`,o,r);var R=(e,t="https://api.polygon.io",o)=>{let r=i(e,t,o);return{aggregates:(...s)=>Pe(r,...s),summaries:(...s)=>we(r,...s),dailyOpenClose:(...s)=>ve(r,...s),previousClose:(...s)=>Se(r,...s),trades:(...s)=>Ge(r,...s),lastTrade:(...s)=>Ae(r,...s),quotes:(...s)=>De(r,...s),snapshotOptionContract:(...s)=>b(r,...s),snapshotOptionChain:(...s)=>f(r,...s),sma:(...s)=>$e(r,...s),ema:(...s)=>Le(r,...s),macd:(...s)=>Fe(r,...s),rsi:(...s)=>Ee(r,...s)}};var x=async(e,t,o,r,s,n,u,p)=>e(`/v2/aggs/ticker/${t}/range/${o}/${r}/${s}/${n}`,u,p);var Me=async(e,t,o,r)=>e(`/v2/aggs/grouped/locale/us/market/stocks/${t}`,o,r);var k=async(e,t,o,r,s)=>e(`/v1/open-close/${t}/${o}`,r,s);var Q=async(e,t,o,r)=>e(`/v2/aggs/ticker/${t}/prev`,o,r);var We=async(e,t,o,r)=>e(`/v2/last/nbbo/${t}`,o,r);var Ne=async(e,t,o,r)=>e(`/v2/last/trade/${t}`,o,r);var Ue=async(e,t,o)=>e("/v2/snapshot/locale/us/markets/stocks/tickers",t,o),ze=async(e,t,o,r)=>e(`/v2/snapshot/locale/us/markets/stocks/${t}`,o,r),He=async(e,t,o,r)=>e(`/v2/snapshot/locale/us/markets/stocks/tickers/${t}`,o,r);var je=async(e,t,o,r)=>e(`/v3/quotes/${t}`,o,r);var Ve=async(e,t,o,r)=>e(`/v3/trades/${t}`,o,r);var T=(e,t="https://api.polygon.io",o)=>{let r=i(e,t,o);return{aggregates:(...s)=>x(r,...s),aggregatesGroupedDaily:(...s)=>Me(r,...s),summaries:(...s)=>te(r,...s),dailyOpenClose:(...s)=>k(r,...s),lastQuote:(...s)=>We(r,...s),lastTrade:(...s)=>Ne(r,...s),previousClose:(...s)=>Q(r,...s),quotes:(...s)=>je(r,...s),snapshotAllTickers:(...s)=>Ue(r,...s),snapshotGainersLosers:(...s)=>ze(r,...s),snapshotTicker:(...s)=>He(r,...s),sma:(...s)=>g(r,...s),ema:(...s)=>l(r,...s),macd:(...s)=>y(r,...s),rsi:(...s)=>d(r,...s),trades:(...s)=>Ve(r,...s)}};var Be=async(e,t,o)=>e("/v3/snapshot/indices/",t,o);var P=(e,t="https://api.polygon.io",o)=>{let r=i(e,t,o);return{aggregates:(...s)=>x(r,...s),dailyOpenClose:(...s)=>k(r,...s),previousClose:(...s)=>Q(r,...s),snapshotTicker:(...s)=>Be(r,...s),sma:(...s)=>g(r,...s),ema:(...s)=>l(r,...s),macd:(...s)=>y(r,...s),rsi:(...s)=>d(r,...s)}};var Xe=(e,t,o)=>({crypto:O(e,t,o),forex:_(e,t,o),reference:C(e,t,o),options:R(e,t,o),stocks:T(e,t,o),indices:P(e,t,o)}),Je=Xe;var Ye=$(require("websocket"),1),a=(e,t)=>{if(!t)throw new Error("api key not provided.");let o=new Ye.default.w3cwebsocket(e);return o.onopen=()=>{o.send(JSON.stringify({action:"auth",params:t}))},o};var v=(e,t="wss://socket.polygon.io")=>a(`${t}/crypto`,e);var S=(e,t="wss://socket.polygon.io")=>a(`${t}/forex`,e);var G=(e,t="wss://socket.polygon.io")=>a(`${t}/indices`,e);var Ze=(e,t="wss://socket.polygon.io")=>a(`${t}/options`,e);var A=(e,t="wss://socket.polygon.io")=>a(`${t}/stocks`,e);var Ke=(e,t)=>({crypto:()=>v(e,t),forex:()=>S(e,t),indices:()=>G(e,t),options:()=>Ze(e,t),stocks:()=>A(e,t)}),et=Ke;var tt=(e,t,o)=>({rest:Je(e,t),websockets:et(e,o)}),pt=tt;0&&(module.exports={cryptoClient,forexClient,getCryptoWebsocket,getForexWebsocket,getIndicesWebsocket,getStocksWebsocket,indicesClient,optionsClient,polygonClient,referenceClient,restClient,snapshotOptionChain,snapshotOptionContract,stocksClient,websocketClient});
