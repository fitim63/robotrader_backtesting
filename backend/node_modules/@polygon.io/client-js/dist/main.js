import Ve from"cross-fetch";var O={fetch:(t,r)=>Ve(t,r)};import{stringify as Be}from"query-string";var k=class extends Error{constructor(o,e="",s=""){super(o);this.status=e,this.request_id=s}},i=(t,r,o={})=>async(e,s={},n={})=>{if(!t)throw new Error("API KEY not configured...");let u=Be(s,{encode:!0}),p=`${r}${e}?${u}`;try{let m=await O.fetch(p,{...o,...n,headers:{...n.headers||o.headers||{},Authorization:`Bearer ${t}`}});if(m.status>=400){let q=await m.text(),x;try{let c=JSON.parse(q);x=new k(c.message,c.status,c.request_id)}catch{x=new Error(q)}throw x}return m?.headers?.get("content-type")==="text/csv"?m.text():m.json()}catch(m){throw m}};var _=async(t,r,o,e,s,n,u,p)=>t(`/v2/aggs/ticker/${r}/range/${o}/${e}/${s}/${n}`,u,p);var C=async(t,r,o,e)=>t(`/v2/aggs/grouped/locale/global/market/crypto/${r}`,o,e);var R=async(t,r,o,e,s,n)=>t(`/v1/open-close/crypto/${r}/${o}/${e}`,s,n);var T=async(t,r,o,e)=>t(`/v3/trades/${r}`,o,e);var P=async(t,r,o,e,s)=>t(`/v1/last/crypto/${r}/${o}`,e,s);var v=async(t,r,o,e)=>t(`/v2/aggs/ticker/${r}/prev`,o,e);var S=(t,r,o)=>t("/v2/snapshot/locale/global/markets/crypto/tickers",r,o),G=(t,r,o,e)=>t(`/v2/snapshot/locale/global/markets/crypto/${r}`,o,e),A=(t,r,o,e)=>t(`/v2/snapshot/locale/global/markets/crypto/tickers/${r}`,o,e),D=(t,r,o,e)=>t(`/v2/snapshot/locale/global/markets/crypto/tickers/${r}/book`,o,e);var w=async(t,r,o)=>t("/v1/summaries",r,o);var I=async(t,r,o,e)=>t(`/v1/indicators/sma/${r}`,o,e);var $=async(t,r,o,e)=>t(`/v1/indicators/sma/${r}`,o,e);var g=async(t,r,o,e)=>t(`/v1/indicators/ema/${r}`,o,e);var L=async(t,r,o,e)=>t(`/v1/indicators/ema/${r}`,o,e);var l=async(t,r,o,e)=>t(`/v1/indicators/macd/${r}`,o,e);var F=async(t,r,o,e)=>t(`/v1/indicators/macd/${r}`,o,e);var y=async(t,r,o,e)=>t(`/v1/indicators/rsi/${r}`,o,e);var E=async(t,r,o,e)=>t(`/v1/indicators/rsi/${r}`,o,e);var M=async(t,r,o)=>t("/v1/summaries",r,o);var W=(t,r="https://api.polygon.io",o)=>{let e=i(t,r,o);return{aggregates:(...s)=>_(e,...s),aggregatesGroupedDaily:(...s)=>C(e,...s),summaries:(...s)=>w(e,...s),dailyOpenClose:(...s)=>R(e,...s),lastTrade:(...s)=>P(e,...s),trades:(...s)=>T(e,...s),previousClose:(...s)=>v(e,...s),snapshotAllTickers:(...s)=>S(e,...s),snapshotGainersLosers:(...s)=>G(e,...s),snapshotTicker:(...s)=>A(e,...s),snapshotTickerFullBookL2:(...s)=>D(e,...s),sma:(...s)=>$(e,...s),ema:(...s)=>L(e,...s),macd:(...s)=>F(e,...s),rsi:(...s)=>E(e,...s)}};var N=async(t,r,o,e,s,n,u,p)=>t(`/v2/aggs/ticker/${r}/range/${o}/${e}/${s}/${n}`,u,p);var U=async(t,r,o,e)=>t(`/v2/aggs/grouped/locale/global/market/fx/${r}`,o,e);var z=async(t,r,o,e,s)=>t(`/v1/conversion/${r}/${o}`,e,s);var H=async(t,r,o,e)=>t(`/v3/quotes/${r}`,o,e);var j=(t,r,o,e,s)=>t(`/v1/last_quote/currencies/${r}/${o}`,e,s);var V=async(t,r,o,e)=>t(`/v2/aggs/ticker/${r}/prev`,o,e);var B=async(t,r,o)=>t("/v2/snapshot/locale/global/markets/forex/tickers",r,o),X=async(t,r,o,e)=>t(`/v2/snapshot/locale/global/markets/forex/${r}`,o,e),J=async(t,r,o,e)=>t(`/v2/snapshot/locale/global/markets/forex/tickers/${r}`,o,e);var Y=async(t,r,o)=>t("/v1/summaries",r,o);var Z=async(t,r,o,e)=>t(`/v1/indicators/sma/${r}`,o,e);var K=async(t,r,o,e)=>t(`/v1/indicators/ema/${r}`,o,e);var ee=async(t,r,o,e)=>t(`/v1/indicators/macd/${r}`,o,e);var te=async(t,r,o,e)=>t(`/v1/indicators/rsi/${r}`,o,e);var re=(t,r="https://api.polygon.io",o)=>{let e=i(t,r,o);return{aggregates:(...s)=>N(e,...s),aggregatesGroupedDaily:(...s)=>U(e,...s),summaries:(...s)=>Y(e,...s),conversion:(...s)=>z(e,...s),quotes:(...s)=>H(e,...s),lastQuote:(...s)=>j(e,...s),previousClose:(...s)=>V(e,...s),snapshotAllTickers:(...s)=>B(e,...s),snapshotGainersLosers:(...s)=>X(e,...s),snapshotTicker:(...s)=>J(e,...s),sma:(...s)=>Z(e,...s),ema:(...s)=>K(e,...s),macd:(...s)=>ee(e,...s),rsi:(...s)=>te(e,...s)}};var se=async(t,r,o)=>t("/v3/reference/conditions",r,o);var oe=async(t,r,o)=>t("/v3/reference/exchanges",r,o);var ne=async(t,r,o)=>t("/v1/marketstatus/upcoming",r,o);var ie=async(t,r,o)=>t("/v1/marketstatus/now",r,o);var ae=(t,r,o,e)=>t(`/v3/reference/options/contracts/${r}`,o,e);var ue=(t,r,o)=>t("/v3/reference/options/contracts",r,o);var pe=async(t,r,o)=>t("/v3/reference/dividends",r,o);var me=async(t,r,o)=>t("/v3/reference/splits",r,o);var ce=async(t,r,o)=>t("/vX/reference/financials",r,o);var Ie=async(t,r,o,e)=>t(`/v3/reference/tickers/${r}`,o,e);var ge=async(t,r,o)=>t("/v2/reference/news",r,o);var le=async(t,r,o)=>t("/v3/reference/tickers",r,o);var ye=async(t,r,o)=>t("/v3/reference/tickers/types",r,o);var de=(t,r="https://api.polygon.io",o)=>{let e=i(t,r,o);return{conditions:(...s)=>se(e,...s),exchanges:(...s)=>oe(e,...s),marketHolidays:(...s)=>ne(e,...s),marketStatus:(...s)=>ie(e,...s),optionsContract:(...s)=>ae(e,...s),optionsContracts:(...s)=>ue(e,...s),dividends:(...s)=>pe(e,...s),stockSplits:(...s)=>me(e,...s),stockFinancials:(...s)=>ce(e,...s),tickerDetails:(...s)=>Ie(e,...s),tickerNews:(...s)=>ge(e,...s),tickers:(...s)=>le(e,...s),tickerTypes:(...s)=>ye(e,...s)}};var fe=async(t,r,o,e,s,n,u,p)=>t(`/v2/aggs/ticker/${r}/range/${o}/${e}/${s}/${n}`,u,p);var be=async(t,r,o,e,s)=>t(`/v1/open-close/${r}/${o}`,e,s);var xe=async(t,r,o,e)=>t(`/v2/aggs/ticker/${r}/prev`,o,e);var ke=async(t,r,o,e)=>t(`/v3/trades/${r}`,o,e);var Qe=async(t,r,o,e)=>t(`/v2/last/trade/${r}`,o,e);var he=async(t,r,o,e)=>t(`/v3/quotes/${r}`,o,e);var Q=async(t,r,o,e)=>t(`/v3/snapshot/options/${r}`,o,e),h=async(t,r,o,e,s)=>t(`/v3/snapshot/options/${r}/${o}`,e,s);var qe=async(t,r,o)=>t("/v1/summaries",r,o);var Oe=async(t,r,o,e)=>t(`/v1/indicators/sma/${r}`,o,e);var _e=async(t,r,o,e)=>t(`/v1/indicators/ema/${r}`,o,e);var Ce=async(t,r,o,e)=>t(`/v1/indicators/macd/${r}`,o,e);var Re=async(t,r,o,e)=>t(`/v1/indicators/rsi/${r}`,o,e);var Te=(t,r="https://api.polygon.io",o)=>{let e=i(t,r,o);return{aggregates:(...s)=>fe(e,...s),summaries:(...s)=>qe(e,...s),dailyOpenClose:(...s)=>be(e,...s),previousClose:(...s)=>xe(e,...s),trades:(...s)=>ke(e,...s),lastTrade:(...s)=>Qe(e,...s),quotes:(...s)=>he(e,...s),snapshotOptionContract:(...s)=>h(e,...s),snapshotOptionChain:(...s)=>Q(e,...s),sma:(...s)=>Oe(e,...s),ema:(...s)=>_e(e,...s),macd:(...s)=>Ce(e,...s),rsi:(...s)=>Re(e,...s)}};var d=async(t,r,o,e,s,n,u,p)=>t(`/v2/aggs/ticker/${r}/range/${o}/${e}/${s}/${n}`,u,p);var Pe=async(t,r,o,e)=>t(`/v2/aggs/grouped/locale/us/market/stocks/${r}`,o,e);var f=async(t,r,o,e,s)=>t(`/v1/open-close/${r}/${o}`,e,s);var b=async(t,r,o,e)=>t(`/v2/aggs/ticker/${r}/prev`,o,e);var ve=async(t,r,o,e)=>t(`/v2/last/nbbo/${r}`,o,e);var Se=async(t,r,o,e)=>t(`/v2/last/trade/${r}`,o,e);var Ge=async(t,r,o)=>t("/v2/snapshot/locale/us/markets/stocks/tickers",r,o),Ae=async(t,r,o,e)=>t(`/v2/snapshot/locale/us/markets/stocks/${r}`,o,e),De=async(t,r,o,e)=>t(`/v2/snapshot/locale/us/markets/stocks/tickers/${r}`,o,e);var we=async(t,r,o,e)=>t(`/v3/quotes/${r}`,o,e);var $e=async(t,r,o,e)=>t(`/v3/trades/${r}`,o,e);var Le=(t,r="https://api.polygon.io",o)=>{let e=i(t,r,o);return{aggregates:(...s)=>d(e,...s),aggregatesGroupedDaily:(...s)=>Pe(e,...s),summaries:(...s)=>M(e,...s),dailyOpenClose:(...s)=>f(e,...s),lastQuote:(...s)=>ve(e,...s),lastTrade:(...s)=>Se(e,...s),previousClose:(...s)=>b(e,...s),quotes:(...s)=>we(e,...s),snapshotAllTickers:(...s)=>Ge(e,...s),snapshotGainersLosers:(...s)=>Ae(e,...s),snapshotTicker:(...s)=>De(e,...s),sma:(...s)=>I(e,...s),ema:(...s)=>g(e,...s),macd:(...s)=>l(e,...s),rsi:(...s)=>y(e,...s),trades:(...s)=>$e(e,...s)}};var Fe=async(t,r,o)=>t("/v3/snapshot/indices/",r,o);var Ee=(t,r="https://api.polygon.io",o)=>{let e=i(t,r,o);return{aggregates:(...s)=>d(e,...s),dailyOpenClose:(...s)=>f(e,...s),previousClose:(...s)=>b(e,...s),snapshotTicker:(...s)=>Fe(e,...s),sma:(...s)=>I(e,...s),ema:(...s)=>g(e,...s),macd:(...s)=>l(e,...s),rsi:(...s)=>y(e,...s)}};var Xe=(t,r,o)=>({crypto:W(t,r,o),forex:re(t,r,o),reference:de(t,r,o),options:Te(t,r,o),stocks:Le(t,r,o),indices:Ee(t,r,o)}),Me=Xe;import Je from"websocket";var a=(t,r)=>{if(!r)throw new Error("api key not provided.");let o=new Je.w3cwebsocket(t);return o.onopen=()=>{o.send(JSON.stringify({action:"auth",params:r}))},o};var We=(t,r="wss://socket.polygon.io")=>a(`${r}/crypto`,t);var Ne=(t,r="wss://socket.polygon.io")=>a(`${r}/forex`,t);var Ue=(t,r="wss://socket.polygon.io")=>a(`${r}/indices`,t);var ze=(t,r="wss://socket.polygon.io")=>a(`${r}/options`,t);var He=(t,r="wss://socket.polygon.io")=>a(`${r}/stocks`,t);var Ye=(t,r)=>({crypto:()=>We(t,r),forex:()=>Ne(t,r),indices:()=>Ue(t,r),options:()=>ze(t,r),stocks:()=>He(t,r)}),je=Ye;var Ze=(t,r,o)=>({rest:Me(t,r),websockets:je(t,o)}),dm=Ze;export{W as cryptoClient,dm as default,re as forexClient,We as getCryptoWebsocket,Ne as getForexWebsocket,Ue as getIndicesWebsocket,He as getStocksWebsocket,Ee as indicesClient,Te as optionsClient,Ze as polygonClient,de as referenceClient,Xe as restClient,Q as snapshotOptionChain,h as snapshotOptionContract,Le as stocksClient,Ye as websocketClient};
